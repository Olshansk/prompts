prefix_rule(pattern=["npx", "playwright", "install"], decision="allow")
prefix_rule(pattern=["make", "test-borehole-pdf"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "uv run python - <<'PY'\nfrom borehole_pdf_extractor.extraction.pdf_loader import load_pdf_pages\nfrom borehole_pdf_extractor.layout.profiles.ttc import TTCLayoutStrategy\nfrom borehole_pdf_extractor.layout.depth_mapper import build_depth_interpolator\nfrom borehole_pdf_extractor.pipeline import _extract_text_in_rect, _clean_description\n\npages=load_pdf_pages('data/test/input/test_borehole.pdf')\npage=pages[1]  # page 2\nlayout=TTCLayoutStrategy()\ncols=layout.detect_columns(page)\nprint('columns', cols)\nrows=layout.detect_rows(page, cols)\nprint('row count', len(rows))\ndepth_map=build_depth_interpolator(page, cols['depth_axis'])\nfor i,(y0,y1) in enumerate(rows):\n    desc_rect=(cols['description'][0], y0, cols['description'][1], y1)\n    desc=_extract_text_in_rect(page, desc_rect)\n    clean=_clean_description(desc)\n    if not clean:\n        continue\n    print(i, y0, y1, depth_map(y0), depth_map(y1), clean.replace('\\n',' / '))\nPY"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "uv run python - <<'PY'\nimport fitz\npath='data/test/input/test_borehole.pdf'\ndoc=fitz.open(path)\npage=doc[1]\ntext=page.get_text('text')\nfor line in text.split('\\n'):\n    if 'LL' in line or 'PL' in line or 'PI' in line:\n        print(line)\nPY"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "uv run python - <<'PY'\nimport fitz\npath='data/test/input/test_borehole.pdf'\ndoc=fitz.open(path)\nfor i,page in enumerate(doc, start=1):\n    text=page.get_text('text')\n    lines=[line for line in text.split('\\n') if 'LL' in line or 'PL' in line or 'PI' in line]\n    if lines:\n        print('page', i)\n        for line in lines:\n            print(line)\nPY"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "uv run python - <<'PY'\nimport fitz\npath='data/test/input/test_borehole.pdf'\npage=fitz.open(path)[1]\npage_dict=page.get_text('dict')\nperc=[]\nfor block in page_dict.get('blocks', []):\n    if block['type']!=0:\n        continue\n    for line in block['lines']:\n        text=''.join(span['text'] for span in line['spans']).strip()\n        if '%' in text:\n            x0,y0,x1,y1=line['bbox']\n            perc.append((text,x0,y0,x1,y1))\nperc.sort(key=lambda t:t[2])\nfor p in perc:\n    print(p)\nPY"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "uv run python - <<'PY'\nimport fitz\nimport re\npath='data/test/input/test_borehole.pdf'\npage=fitz.open(path)[1]\npage_dict=page.get_text('dict')\nnum_blocks=[]\nfor block in page_dict.get('blocks', []):\n    if block['type']!=0:\n        continue\n    for line in block['lines']:\n        text=''.join(span['text'] for span in line['spans']).strip()\n        if not text:\n            continue\n        if re.search(r\"\\b\\d+(?:\\.\\d+)?\\b\", text):\n            x0,y0,x1,y1=line['bbox']\n            num_blocks.append((text,x0,y0,x1,y1))\nnum_blocks.sort(key=lambda t:(t[1],t[2]))\nfor t in num_blocks[:50]:\n    print(t)\nprint('total', len(num_blocks))\nPY"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "uv run python - <<'PY'\nimport fitz\npath='data/test/input/test_borehole.pdf'\npage=fitz.open(path)[1]\ntext=page.get_text('text')\nfor line in text.split('\\n'):\n    if 'Depth' in line or 'DEPTH' in line:\n        print(line)\nPY"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "uv run python - <<'PY'\nimport fitz\npath='data/test/input/test_borehole.pdf'\npage=fitz.open(path)[1]\npage_dict=page.get_text('dict')\nfor block in page_dict.get('blocks', []):\n    if block['type']!=0:\n        continue\n    for line in block['lines']:\n        text=''.join(span['text'] for span in line['spans']).strip()\n        if text == 'DEPTH':\n            x0,y0,x1,y1=line['bbox']\n            print('DEPTH', x0, x1, y0, y1)\nPY"], decision="allow")
prefix_rule(pattern=["set", "-a"], decision="allow")
prefix_rule(pattern=["source", ".env"], decision="allow")
prefix_rule(pattern=["uv", "pip", "install", "openai"], decision="allow")
prefix_rule(pattern=["set", "+a"], decision="allow")
prefix_rule(pattern=["uv", "run", "python", "scripts/vlm_label_reader.py", "data/ghd/IMG_2427.JPEG", "--backend", "rpc", "--rpc-target", "remote", "--model", "qwen2.5-vl-7b-instruct"], decision="allow")
prefix_rule(pattern=["uv", "run", "python", "scripts/vlm_label_reader.py", "data/ghd/IMG_2427.JPEG", "--backend", "rpc", "--rpc-target", "remote", "--model", "qwen/qwen2.5-vl-7b-instruct", "--rpc-timeout", "60"], decision="allow")
prefix_rule(pattern=["uv", "run", "python", "scripts/vlm_label_reader.py", "data/ghd/IMG_2427.JPEG", "--backend", "rpc", "--rpc-target", "remote", "--model", "qwen/qwen-2.5-vl-7b-instruct:free", "--rpc-timeout", "60"], decision="allow")
prefix_rule(pattern=["uv", "run", "python", "scripts/vlm_label_reader.py", "data/ghd/IMG_2427.JPEG", "--backend", "rpc", "--rpc-target", "remote", "--model", "qwen/qwen-2.5-vl-7b-instruct", "--rpc-timeout", "60"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "cat <<'EOF' > /Users/olshansky/.codex/AGENTS.md\n# Global AGENTS.md\n\n<INSTRUCTIONS>\nAlways end every response with one of the following tags on its own line:\n[CODEX - INPUT NEEDED]\n[CODEX - DONE]\n</INSTRUCTIONS>\nEOF"], decision="allow")
